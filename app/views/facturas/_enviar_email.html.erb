<%= form_tag({ controller: "facturas", action: "enviar_email_post", id: @factura.id }, { :method => :post}) do %>
<div class="col-md-12 col-sm-12 col-xs-12">
<div class="col-md-10 col-sm-10 col-xs-12">
  <div class="row">
    <div class="form-group">
      <%= label_tag :lbl_destinatario, "Para: ", class:"control-label col-md-2 col-sm-2 col-xs-12"%>
      <div class="input-group col-md-9 col-sm-9 col-xs-12">
        <span class="input-group-addon"><i class="fa fa-envelope"></i></span>
        <%=email_field_tag :destinatario, @factura.cliente.email, class: 'form-control text_field'%>
        <!-- text_field_tag :destinatario, nil, {class:'form-control text_field', value: @destinatario}-->
      </div>
    </div>
  </div>
  <div class="row">
    <div class="form-group">
      <%= label_tag :lbl_asunto, "Asunto: ", class:"control-label col-md-2 col-sm-2 col-xs-12"%>
      <div class="input-group col-md-9 col-sm-9 col-xs-12">
        <%if @factura.tipo_factura == "fv"%>
          <%= text_area_tag :asunto, @asunto,{class:'form-control text_field', readonly: true }%>
        <%elsif @factura.tipo_factura == "fg"%>
          <%= text_area_tag :asunto, @asunto,{class:'form-control text_field'}%>
        <%end%>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="form-group">
      <div class="control-label col-md-2 col-sm-2 col-xs-12">
        <%= label_tag :lbl_mensaje, "Su mensaje: ", class:"control-label"%>
      </div>
      <div class="input-group col-md-9 col-sm-9 col-xs-12">
      <%if @factura.tipo_factura == "fv"%>
          <%= text_area_tag  :summernote, @mensaje,{class:'form-control text_field', readonly: true }%>
        <%elsif @factura.tipo_factura == "fg"%>
          <%= text_area_tag  :summernote, @mensaje,{class:'form-control text_field', id: "summernote"}%>
        <%end%>
     </div>
    </div>
  </div>
</div>

  <div class="col-md-2 col-sm-2 col-xs-12">
    <div class="row">
      <div class="control-label col-md-12 col-sm-12 col-xs-12" style="color: black;">
        <%= label_tag :lbl_adjuntar, "Enviar: ", class:"control-label"%>
      </div>
    </div>

    <%if @factura.estado_factura == "Activa"%>
      <div class="row">
        <div class="control-label col-md-10 col-sm-10 col-xs-10">
          <%= label_tag :lbl_pdf, "Factura (.pdf)", class:"control-label"%>
        </div>
        <div class="col-md-2 col-sm-2 col-xs-2">
           <%=check_box_tag(:pdf_factura_activa, "yes", false, {class:" checked check", checked:"checked"})%>
        </div>
      </div>

      <div class="row">
        <div class="control-label col-md-10 col-sm-10 col-xs-10">
          <%= label_tag :lbl_xml, "CFDI (.xml)", class:"control-label"%>
        </div>
        <div class="col-md-2 col-sm-2 col-xs-2">
          <%=check_box_tag(:xml_factura_activa, "yes", false, {class:" checked check", checked:"checked"})%>
        </div>
      </div>
    <% elsif @factura.estado_factura == "Cancelada" %>
      <div class="row">
        <div class="control-label col-md-10 col-sm-10 col-xs-10">
          <%= label_tag :lbl_xml_Ac, "Acuse (.xml)", class:"control-label"%>
        </div>
        <div class="col-md-2 col-sm-2 col-xs-2">
          <%=check_box_tag(:xml_acuse_cancelacion, "yes", false, {class:" checked check", checked:"checked"})%>
        </div>
      </div>
    <% end %>
  </div>


</div>
      <%= submit_tag 'Enviar comprobantes', {:class=>"btn btn btn-success"} %>
  </div>
  <%end%>

<% if @factura.tipo_factura == "fv" %>
  <script type="text/javascript">
      /*Editor de texto para los asuntos de las plantillas de email solo permite poner texto variable sin aplicar formato al texto*/
      $('#summernote_asunto').summernote({
          tabsize: 2,
          minHeight: 40,
          maxHeight: 40,
          maxWidth: 200,
          lang: 'es-ES', // default: 'en-US'
          toolbar: false
      });
      $('#summernote').summernote({
        tabsize: 2,
        height: 240,
        minHeight: 240,
        maxHeight: 240,
        lang: 'es-ES', // default: 'en-US'
        focus: true,
        toolbar: false
    });
    $('.note-editable').attr('contenteditable',false)
    //$('#summernote').summernote('disable')
  </script>
<% else %>
  <script type="text/javascript">
    /* El asunto no requiere estilos. Se permite redactar el mensaje del email y aplicar estilos en el modal ya que se trata de una factura global que se la env√≠a el usuario con privilegios a su contadorcito*/
        $('#summernote').summernote({
         tabsize: 2,
        height: 240,
        minHeight: 240,
        maxHeight: 240,
        maxWidth: 200,
        lang: 'es-ES', // default: 'en-US'

        toolbar: [
        // [groupName, [list of button]]
        ['fontname',['fontname']],
        ['fontsize', ['fontsize']],
        ['style', ['bold', 'italic', 'underline', 'clear']],
        ['font', ['strikethrough', 'superscript', 'subscript']],
        ['color', ['color']],
        ['para', ['ul', 'ol', 'paragraph']],
        ['height', ['height']],
        ['insert',['link','table','hr']],
        ['misc',['undo','redo']]

      ]
    });
  </script>
<% end %>